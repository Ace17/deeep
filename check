#!/bin/bash

set -euo pipefail

MAKE="make -j`nproc`"

scripts/reformat.sh src

echo "----------------------------------------------------------------"
echo "Building asmjs version"

PATH=/home/ace/source/emscripten/emsdk_portable/emscripten/master/system/bin:$PATH \
  BIN=bin/asmjs \
  CXX=emcc \
  CXXFLAGS="-g0 -DNDEBUG" \
  LDFLAGS="-Xlinker,-s -g0 --preload-file res" \
  $MAKE

echo "----------------------------------------------------------------"
echo "Building native version"

BIN=bin/native \
  CXX=g++ \
  $MAKE

